<% include ../partials/header %>
<link rel="stylesheet" type="text/css" href="/stylesheets/thumbnail.css">
<div class="container">
<div clas="row">
	<div class="container">
		<div class="container-fluid thumbnails">
			<div class='row'>
				<div class="col-sm-3"></div>
				<div class='col-sm-6'>
					<img class="img-rounded img-responsive" src="../uploads/<%=detail.img.data%>">
				</div>
				<div class="col-sm-3"></div>
			</div>
			<div class="caption-full">
				<h4><a href="#"><%=detail.name%></a></h4>
			</div>
			<div>
				<%=detail.details%>
			</div>
			<p><em>Submitted By <%=detail.author.username%></em></p>
			<% if(currentUser){ %>
				<%if(detail.author.id.equals(currentUser.id)){%>
				<div>
					<a href="/places/<%=detail.id%>/edit" class="btn btn-warning">Edit</a>
					<form action="/places/<%=detail._id%>?_method=DELETE" class="inlineform" method="POST">
						<button class="btn btn-danger">Delete</button>
					</form>
				</div>
				<%}%>
			<%}%>
		</div>
		<div class="well">
			<div class="text-right">
				<a class="btn btn-success" id=""href="/places/<%=detail._id%>/comments/new">Add New Comment</a>
				<script type="text/javascript">
					
				</script>
		
			</div>
			
			
			<% detail.comments.forEach(function(comment){%>
			<div class="row">
				<div class="col-md-12">
					<strong><%=comment.author.username%></strong>
					<span class="pull-right"</span>
					<p>
						<%=comment.text%>
					</p>
					<div>
					<% if(currentUser){ %>
						<% if(comment.author.id.equals(currentUser.id)){%>
							<a href="/places/<%=detail._id%>/comments/<%=comment._id%>/edit" class="btn btn-info btn-xs">Edit</a>
							<form action="/places/<%=detail._id%>/comments/<%=comment._id%>?_method=DELETE" class="inlineform" method="POST">
								<input type="submit" class="btn btn-danger btn-xs" name="button" value="Delete">
							</form>
							<hr>
						<%}%>
					<%}%>
					</div>
				</div>
			</div>
			<%})%>
			
		</div>
	</div>
</div>
	<style>
       #map {
        height: 400px;
        width: 100%;
       }
    </style>
	<div id="map"></div>
    <script>
		function initMap() {
			var myLatlng = {
		    	lat: <%= detail.latitude %>,
		    	lng: <%= detail.longitude %>
		  	};

		  	var map = new google.maps.Map(document.getElementById('map'), {
		    	zoom: 12,
		    	center: myLatlng
		  	});

		  	var marker = new google.maps.Marker({
		    	position: myLatlng,
		    	map: map,
		    	title: 'Click to zoom'
		  	});
		}
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCrDFDqmbefeEWWQdD0l2kSPG8XD9yPOSk&callback=initMap">
    </script>
</div>
<% include ../partials/footer %>